(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[331],{4480:function(e,t,s){Promise.resolve().then(s.bind(s,9222))},9222:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return o}});var r=s(7437),i=s(2265),n=s(6716),a=s(1387),c=s(2435),l=s(5823),d=s(3557);function o(){let[e,t]=(0,i.useState)([]),[s,o]=(0,i.useState)(!0),[h,u]=(0,i.useState)(!1),[m,x]=(0,i.useState)(null),[j,g]=(0,i.useState)({name:"",description:"",defaultImage:""});(0,i.useEffect)(()=>{f()},[]);let f=async()=>{try{let e=await fetch("/api/categories");if(!e.ok)throw Error("Failed to fetch categories");let s=await e.json();t(s)}catch(e){console.error("Error fetching categories:",e)}finally{o(!1)}},p=async e=>{e.preventDefault();try{let e=m?"/api/categories/".concat(m.id):"/api/categories";if(!(await fetch(e,{method:m?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(j)})).ok)throw Error("Failed to save category");f(),y()}catch(e){console.error("Error saving category:",e)}},v=async e=>{if(window.confirm("Are you sure you want to delete this category?"))try{if(!(await fetch("/api/categories/".concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete category");f()}catch(e){console.error("Error deleting category:",e)}},y=()=>{u(!1),x(null),g({name:"",description:"",defaultImage:""})},Z=e=>{x(e),g({name:e.name,description:e.description||"",defaultImage:e.defaultImage||""}),u(!0)};return s?(0,r.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"200px"},children:(0,r.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,r.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}):(0,r.jsx)(d.Z,{children:(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"h3 mb-1",children:"Categories"}),(0,r.jsx)("p",{className:"text-muted mb-0",children:"Manage training categories"})]}),(0,r.jsx)(n.Z,{onClick:()=>u(!0),children:"Add Category"})]}),(0,r.jsxs)(a.Z,{hover:!0,responsive:!0,children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Name"}),(0,r.jsx)("th",{children:"Description"}),(0,r.jsx)("th",{children:"Resources"}),(0,r.jsx)("th",{children:"Created"}),(0,r.jsx)("th",{children:"Actions"})]})}),(0,r.jsx)("tbody",{children:e.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.name}),(0,r.jsx)("td",{children:e.description}),(0,r.jsxs)("td",{children:[e._count.resources," resources"]}),(0,r.jsx)("td",{children:new Date(e.createdAt).toLocaleDateString()}),(0,r.jsxs)("td",{children:[(0,r.jsx)(n.Z,{variant:"outline-primary",size:"sm",className:"me-2",onClick:()=>Z(e),children:"Edit"}),(0,r.jsx)(n.Z,{variant:"outline-danger",size:"sm",onClick:()=>v(e.id),children:"Delete"})]})]},e.id))})]}),(0,r.jsxs)(c.Z,{show:h,onHide:y,children:[(0,r.jsx)(c.Z.Header,{closeButton:!0,children:(0,r.jsx)(c.Z.Title,{children:m?"Edit Category":"Add Category"})}),(0,r.jsx)(c.Z.Body,{children:(0,r.jsxs)(l.Z,{onSubmit:p,children:[(0,r.jsxs)(l.Z.Group,{className:"mb-3",children:[(0,r.jsx)(l.Z.Label,{children:"Name"}),(0,r.jsx)(l.Z.Control,{type:"text",value:j.name,onChange:e=>g({...j,name:e.target.value}),required:!0})]}),(0,r.jsxs)(l.Z.Group,{className:"mb-3",children:[(0,r.jsx)(l.Z.Label,{children:"Description"}),(0,r.jsx)(l.Z.Control,{as:"textarea",rows:3,value:j.description,onChange:e=>g({...j,description:e.target.value})})]}),(0,r.jsxs)(l.Z.Group,{className:"mb-3",children:[(0,r.jsx)(l.Z.Label,{children:"Default Image URL"}),(0,r.jsx)(l.Z.Control,{type:"url",value:j.defaultImage,onChange:e=>g({...j,defaultImage:e.target.value})})]}),(0,r.jsxs)("div",{className:"d-flex justify-content-end gap-2",children:[(0,r.jsx)(n.Z,{variant:"secondary",onClick:y,children:"Cancel"}),(0,r.jsx)(n.Z,{variant:"primary",type:"submit",children:m?"Save Changes":"Add Category"})]})]})})]})]})})}},3557:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var r=s(7437),i=s(2749),n=s(4033),a=s(2265),c=s(382);function l(e){var t;let{children:s}=e,{data:l,status:d}=(0,i.useSession)(),o=(0,n.useRouter)();return((0,a.useEffect)(()=>{var e;"unauthenticated"===d?o.push("/auth/signin"):"authenticated"!==d||(null==l?void 0:null===(e=l.user)||void 0===e?void 0:e.isAdmin)||o.push("/")},[d,l,o]),"loading"===d)?(0,r.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"200px"},children:(0,r.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,r.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}):(null==l?void 0:null===(t=l.user)||void 0===t?void 0:t.isAdmin)?(0,r.jsx)(r.Fragment,{children:s}):(0,r.jsxs)(c.Z,{variant:"danger",className:"m-4",children:[(0,r.jsx)(c.Z.Heading,{children:"Access Denied"}),(0,r.jsx)("p",{children:"You need administrator privileges to access this page."})]})}},1387:function(e,t,s){"use strict";var r=s(2744),i=s.n(r),n=s(2265),a=s(5956),c=s(7437);let l=n.forwardRef(({bsPrefix:e,className:t,striped:s,bordered:r,borderless:n,hover:l,size:d,variant:o,responsive:h,...u},m)=>{let x=(0,a.vE)(e,"table"),j=i()(t,x,o&&`${x}-${o}`,d&&`${x}-${d}`,s&&`${x}-${"string"==typeof s?`striped-${s}`:"striped"}`,r&&`${x}-bordered`,n&&`${x}-borderless`,l&&`${x}-hover`),g=(0,c.jsx)("table",{...u,className:j,ref:m});if(h){let e=`${x}-responsive`;return"string"==typeof h&&(e=`${e}-${h}`),(0,c.jsx)("div",{className:e,children:g})}return g});t.Z=l}},function(e){e.O(0,[749,963,372,756,435,971,938,744],function(){return e(e.s=4480)}),_N_E=e.O()}]);